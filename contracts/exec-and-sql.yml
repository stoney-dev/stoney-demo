version: 1
feature: demo
description: Exec + SQL checks (v1 format)

contracts:
  - name: exec_checks
    description: Basic CI runtime validation.
    checks:
      - id: node_present
        work_item: "KAN-124"
        says: "CI runner must have Node installed"
        steps:
          - exec:
              run: "node -v"
            expect:
              exit_code: 0
              stdout_contains: "v"

  - name: db_invariants
    description: Basic DB connectivity validation.
    checks:
      - id: db_smoke
        work_item: "KAN-125"
        says: "Database must be reachable and able to execute a simple query"
        steps:
          - sql:
              driver: postgres
              url_env: STONEY_DB_URL
              query: "SELECT 1 AS ok;"
            expect:
              rows: 1
              equals:
                ok: 1